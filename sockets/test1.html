<!DOCTYPE html>
<html>
<head>
  <title>ðŸ”´ Realtime Chat Test</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, button { margin: 5px 0; padding: 8px; width: 100%; }
    #chat { margin-top: 20px; padding: 0; list-style: none; }
    li { margin: 5px 0; padding: 6px; border: 1px solid #ccc; border-radius: 5px; }
  </style>
</head>
<body>
  <h2>ðŸ”„ Realtime Messaging via Socket.IO</h2>

  <label for="receiverId">Receiver User ID:</label>
  <input type="text" id="receiverId" placeholder="Paste Receiver's User ID here" />

  <label for="messageInput">Message:</label>
  <input type="text" id="messageInput" placeholder="Type your message..." />

  <button onclick="sendMessage()">ðŸ“¤ Send Message</button>

  <h3>ðŸ’¬ Chat Log:</h3>
  <ul id="chat"></ul>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6InVzZXItYS1kZjE5M2QwNCIsImlhdCI6MTc1MTk3MjE5MywiZXhwIjoxNzUyNTc2OTkzfQ.iW-7jYDlF0Sgm78HcOiSBNcpNN4Ge13XK4nWk0j5QfU"; // ðŸ” Replace this with a real JWT

    const socket = io("http://localhost:4242", {
      auth: { token }
    });

    socket.on("connect", () => {
      console.log("âœ… Connected with socket ID:", socket.id);
    });

    socket.on("disconnect", () => {
      console.log("âŒ Disconnected from server");
    });

    socket.on("receive_message", (msg) => {
      console.log("ðŸ“¥ Received:", msg);
      addMessage(`[${msg.sender} âž¡ ${msg.receiver}] ${msg.text}`);
    });

    socket.on("message_sent", (msg) => {
      addMessage(`âœ… You: ${msg.text}`);
    });

    function sendMessage() {
      const to = document.getElementById("receiverId").value.trim();
      const text = document.getElementById("messageInput").value.trim();
      if (!to || !text) return alert("Please enter both receiver ID and message.");
      socket.emit("send_message", { to, text });
      document.getElementById("messageInput").value = "";
    }

    function addMessage(content) {
      const li = document.createElement("li");
      li.textContent = content;
      document.getElementById("chat").appendChild(li);
    }
  </script>
</body>
</html>
